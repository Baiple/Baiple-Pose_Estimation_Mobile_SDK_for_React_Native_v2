{"version":3,"names":["postCreateFragment","viewId","UIManager","dispatchViewManagerCommand","PoseDetectView","Commands","create","toString","postStartRecord","Platform","OS","startRecord","postStopRecord","stopRecord","React","forwardRef","props","ref","refSelf","useImperativeHandle","console","log","current","_onCameraError","e","nativeEvent","msg","onCameraError","_onModelError","onModelError","_onPoseDetected","pose","score","onPoseDetected","style","modelPath"],"sources":["PoseDetectView.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { UIManager, Platform, findNodeHandle } from 'react-native';\n\nimport { PdManager, Props } from './PdManager';\n\nconst postCreateFragment = (viewId: number | null) =>\n  UIManager.dispatchViewManagerCommand(\n    viewId,\n    // @ts-ignore\n    UIManager.PoseDetectView.Commands.create.toString(),\n    [viewId],\n  );\n\nconst postStartRecord = (viewId: number | null) => {\n  if (Platform.OS === 'android') {\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // @ts-ignore\n      UIManager.PoseDetectView.Commands.startRecord.toString(),\n      [viewId],\n    );\n  } else {\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // @ts-ignore\n      UIManager.PoseDetectView.Commands.startRecord,\n      [],\n    );\n  }\n};\n\nconst postStopRecord = (viewId: number | null) => {\n  if (Platform.OS === 'android') {\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // @ts-ignore\n      UIManager.PoseDetectView.Commands.stopRecord.toString(),\n      [viewId],\n    );\n  } else {\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // @ts-ignore\n      UIManager.PoseDetectView.Commands.stopRecord,\n      [],\n    );\n  }\n};\n\nexport const PoseDetectView = React.forwardRef((props: Props, ref) => {\n  const refSelf = useRef(null);\n\n  React.useImperativeHandle(ref, () => ({\n    startRecord: () => {\n      console.log('will call startRecord');\n      postStartRecord(findNodeHandle(refSelf.current));\n    },\n    stopRecord: () => {\n      console.log('will call stopRecord');\n      postStopRecord(findNodeHandle(refSelf.current));\n    },\n  }));\n\n  useEffect(() => {\n    const viewId = findNodeHandle(refSelf.current);\n    if (Platform.OS === 'android') {\n      postCreateFragment(viewId);\n    }\n  }, []);\n\n  const _onCameraError = (e: any) => {\n    console.log('JS onCameraError:', e.nativeEvent?.msg);\n    props.onCameraError(e.nativeEvent?.msg);\n  };\n\n  const _onModelError = (e: any) => {\n    console.log('JS onModelError:', e.nativeEvent?.msg);\n    props.onModelError(e.nativeEvent?.msg);\n  };\n\n  const _onPoseDetected = (e: any) => {\n    const { pose, score } = e.nativeEvent ?? {};\n    //console.log('JS onPoseDetected:', pose, score);\n    props.onPoseDetected(pose, score);\n  };\n\n  return (\n    <PdManager\n      // @ts-ignore\n      style={props.style}\n      modelPath={props.modelPath}\n      onCameraError={_onCameraError}\n      onModelError={_onModelError}\n      onPoseDetected={_onPoseDetected}\n      ref={refSelf}\n    />\n  );\n});\n"],"mappings":"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"}