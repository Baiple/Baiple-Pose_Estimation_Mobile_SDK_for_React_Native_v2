{"version":3,"names":["React","useEffect","useRef","UIManager","Platform","findNodeHandle","PdManager","postCreateFragment","viewId","dispatchViewManagerCommand","PoseDetectView","Commands","create","toString","postStartRecord","OS","startRecord","postStopRecord","stopRecord","forwardRef","props","ref","refSelf","useImperativeHandle","console","log","current","_onCameraError","e","nativeEvent","msg","onCameraError","_onModelError","onModelError","_onPoseDetected","pose","score","onPoseDetected","style","modelPath"],"sources":["PoseDetectView.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { UIManager, Platform, findNodeHandle } from 'react-native';\n\nimport { PdManager, Props } from './PdManager';\n\nconst postCreateFragment = (viewId: number | null) =>\n  UIManager.dispatchViewManagerCommand(\n    viewId,\n    // @ts-ignore\n    UIManager.PoseDetectView.Commands.create.toString(),\n    [viewId],\n  );\n\nconst postStartRecord = (viewId: number | null) => {\n  if (Platform.OS === 'android') {\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // @ts-ignore\n      UIManager.PoseDetectView.Commands.startRecord.toString(),\n      [viewId],\n    );\n  } else {\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // @ts-ignore\n      UIManager.PoseDetectView.Commands.startRecord,\n      [],\n    );\n  }\n};\n\nconst postStopRecord = (viewId: number | null) => {\n  if (Platform.OS === 'android') {\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // @ts-ignore\n      UIManager.PoseDetectView.Commands.stopRecord.toString(),\n      [viewId],\n    );\n  } else {\n    UIManager.dispatchViewManagerCommand(\n      viewId,\n      // @ts-ignore\n      UIManager.PoseDetectView.Commands.stopRecord,\n      [],\n    );\n  }\n};\n\nexport const PoseDetectView = React.forwardRef((props: Props, ref) => {\n  const refSelf = useRef(null);\n\n  React.useImperativeHandle(ref, () => ({\n    startRecord: () => {\n      console.log('will call startRecord');\n      postStartRecord(findNodeHandle(refSelf.current));\n    },\n    stopRecord: () => {\n      console.log('will call stopRecord');\n      postStopRecord(findNodeHandle(refSelf.current));\n    },\n  }));\n\n  useEffect(() => {\n    const viewId = findNodeHandle(refSelf.current);\n    if (Platform.OS === 'android') {\n      postCreateFragment(viewId);\n    }\n  }, []);\n\n  const _onCameraError = (e: any) => {\n    console.log('JS onCameraError:', e.nativeEvent?.msg);\n    props.onCameraError(e.nativeEvent?.msg);\n  };\n\n  const _onModelError = (e: any) => {\n    console.log('JS onModelError:', e.nativeEvent?.msg);\n    props.onModelError(e.nativeEvent?.msg);\n  };\n\n  const _onPoseDetected = (e: any) => {\n    const { pose, score } = e.nativeEvent ?? {};\n    //console.log('JS onPoseDetected:', pose, score);\n    props.onPoseDetected(pose, score);\n  };\n\n  return (\n    <PdManager\n      // @ts-ignore\n      style={props.style}\n      modelPath={props.modelPath}\n      onCameraError={_onCameraError}\n      onModelError={_onModelError}\n      onPoseDetected={_onPoseDetected}\n      ref={refSelf}\n    />\n  );\n});\n"],"mappings":"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"}